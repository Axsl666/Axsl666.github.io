<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-NetworkProtocolSecurity/SET">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">SET 协议 | Jellyfish Page</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.axsl.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.axsl.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.axsl.site/docs/NetworkProtocolSecurity/SET"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SET 协议 | Jellyfish Page"><meta data-rh="true" name="description" content="0x01 前言"><meta data-rh="true" property="og:description" content="0x01 前言"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.axsl.site/docs/NetworkProtocolSecurity/SET"><link data-rh="true" rel="alternate" href="https://www.axsl.site/en/docs/NetworkProtocolSecurity/SET" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.axsl.site/docs/NetworkProtocolSecurity/SET" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://www.axsl.site/docs/NetworkProtocolSecurity/SET" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Jellyfish Page RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Jellyfish Page Atom Feed">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.66d1563d.css">
<link rel="preload" href="/assets/js/runtime~main.b33e5218.js" as="script">
<link rel="preload" href="/assets/js/main.1db32412.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Axsl</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Axsl666/Axsl666.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item green"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="打开/收起侧边栏菜单「Tutorial - Basics」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="打开/收起侧边栏菜单「Tutorial - Extras」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed red"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/cryptography">Cryptography</a><button aria-label="打开/收起侧边栏菜单「Cryptography」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item red"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/网络与协议安全基础">网络与协议安全基础</a><button aria-label="打开/收起侧边栏菜单「网络与协议安全基础」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/NetworkProtocolSecurity/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/NetworkProtocolSecurity/Kerberos">Kerberos协议</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/NetworkProtocolSecurity/ipsec">IPsec协议</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/NetworkProtocolSecurity/SET">SET 协议</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/NetworkProtocolSecurity/PGP">PGP协议</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/NetworkProtocolSecurity/ban">BAN逻辑</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/NetworkProtocolSecurity/attack">基于攻击结构性方法</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2023秋冬季开源操作系统训练营">2023秋冬季开源操作系统训练营</a><button aria-label="打开/收起侧边栏菜单「2023秋冬季开源操作系统训练营」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/网络与协议安全基础"><span itemprop="name">网络与协议安全基础</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SET 协议</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>SET 协议</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x01-前言">0x01 前言<a href="#0x01-前言" class="hash-link" aria-label="0x01 前言的直接链接" title="0x01 前言的直接链接">​</a></h2><ul><li>电子支付的流程<ul><li>如何实现信用卡的安全支付？</li><li>安全支付的网络结构？ </li><li>如何在持卡人，商家，银行之间实现信息的按需分配？</li></ul></li><li>数字签名、双重数字签名</li><li>Secure Electronic Transaction，SET过程</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="internet上的电子商务安全问题">Internet上的电子商务安全问题<a href="#internet上的电子商务安全问题" class="hash-link" aria-label="Internet上的电子商务安全问题的直接链接" title="Internet上的电子商务安全问题的直接链接">​</a></h3><ul><li>问题: 信用卡，交易数据，信任关系<ul><li>买家和商家的认证</li><li>数据传输的保密性</li><li>交易抗抵赖性</li><li>消息完整性</li></ul></li><li>各类系统之间的差异<ul><li>公钥类型</li><li>对称密钥类型</li><li>消息摘要算法</li><li>拥有私钥方的数目</li><li>拥有证书方的数目</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="电子交易的主要模式">电子交易的主要模式<a href="#电子交易的主要模式" class="hash-link" aria-label="电子交易的主要模式的直接链接" title="电子交易的主要模式的直接链接">​</a></h3><p>电子商务中常见的电子交易有以下五种类型： </p><ul><li>支付系统无安全措施的模式</li><li>通过第三方代理人支付的模式</li><li>数字现金支付模式</li><li>简单加密支付系统模式</li><li>安全电子交易SET支付模式</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-支付系统无安全措施的模型">1 支付系统无安全措施的模型<a href="#1-支付系统无安全措施的模型" class="hash-link" aria-label="1 支付系统无安全措施的模型的直接链接" title="1 支付系统无安全措施的模型的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416141148935" src="/assets/images/image-20230416141148935-241387d85385dd04d534ec627f95a562.png" width="1324" height="248" class="img_ev3q"></p><ul><li>风险由商家承担 </li><li>商家完全掌握用户的信用卡信息 </li><li>信用卡信息的传递无安全保障 </li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-通过第三方经纪人支付的模型">2 通过第三方经纪人支付的模型<a href="#2-通过第三方经纪人支付的模型" class="hash-link" aria-label="2 通过第三方经纪人支付的模型的直接链接" title="2 通过第三方经纪人支付的模型的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416141229736" src="/assets/images/image-20230416141229736-1201fda0b869d1899ea393c6b1635246.png" width="1138" height="500" class="img_ev3q"></p><ul><li>用户账户的开设不通过网络 </li><li>信用卡信息不在开放的网络上传送 </li><li>通过电子邮件来确认用户身份 </li><li>商家自由度大，风险小 </li><li>支付通过双方都信任的第三方(经纪人TTP？)完成 </li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-数字现金支付模型">3 数字现金支付模型<a href="#3-数字现金支付模型" class="hash-link" aria-label="3 数字现金支付模型的直接链接" title="3 数字现金支付模型的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416141404723" src="/assets/images/image-20230416141404723-56494b5e40a2db5d9d10ad47b6caaf7c.png" width="986" height="447" class="img_ev3q"></p><ul><li>银行和商家之间应有协议和授权关系</li><li>用户、商家和数字现金的发行都需要使用数字现金软件 </li><li>适用于小额交易 </li><li>身份验证是由数字现金本身完成的 </li><li>数字现金的发行方负责用户和商家之间实际资金的转移 </li><li>数字现金与普通现金一样，可以存、取和转让</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-简单加密支付系统模式">4 简单加密支付系统模式<a href="#4-简单加密支付系统模式" class="hash-link" aria-label="4 简单加密支付系统模式的直接链接" title="4 简单加密支付系统模式的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416141540540" src="/assets/images/image-20230416141540540-99c8ee17d2cfb16ec14bacea768ca15a.png" width="893" height="472" class="img_ev3q"></p><ul><li>信用卡等关键信息需要加密 </li><li>使用对称和非对称加密技术 </li><li>可能要启用身份认证系统 </li><li>以数字签名确认信息的真实性 </li><li>需要业务服务器和服务软件的支持 </li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-安全电子交易set支付模式">5 安全电子交易SET支付模式<a href="#5-安全电子交易set支付模式" class="hash-link" aria-label="5 安全电子交易SET支付模式的直接链接" title="5 安全电子交易SET支付模式的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416141628821" src="/assets/images/image-20230416141628821-6c7ea3655aef593966536871412e1f73.png" width="879" height="440" class="img_ev3q"></p><p>SET协议的目标</p><ul><li>信息在互联网上<strong>安全传输，不能被窃听或篡改</strong></li><li>用户资料要妥善保护，<strong>商家只能看到订货信息，看不到用户的账户信息</strong></li><li><strong>持卡人和商家相互认证</strong>，以确定对方身份</li><li><strong>软件遵循相同的协议和消息格式</strong>，具有兼容性和互操作性</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3d-安全支付">3D 安全支付<a href="#3d-安全支付" class="hash-link" aria-label="3D 安全支付的直接链接" title="3D 安全支付的直接链接">​</a></h3><ul><li><strong>Acquirer Domain</strong> – The acquirer domain covers the relationship between the merchant and acquirer.</li><li><strong>Issuer Domai</strong>n – The issuer domain covers the relationship between the cardholder and the issuer.</li><li><strong>Interoperability Domain</strong> – The relationship between the acquirer and issuer domains is supported by the interoperability domain. </li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3d-secure">3D Secure<a href="#3d-secure" class="hash-link" aria-label="3D Secure的直接链接" title="3D Secure的直接链接">​</a></h4><p>C: 持卡人
M：商家
I：Issuer，发卡行
A：Acquirer，收单机构（代表商家）
VisaNet：Visa专用支付网络
ACS：持卡人认证服务器
MPI：商家SSL插件</p><p><img loading="lazy" alt="image-20230416142006302" src="/assets/images/image-20230416142006302-c5daad4084a1a2fb47e3b6000c96bbc3.png" width="1175" height="937" class="img_ev3q"></p><p><img loading="lazy" alt="image-20230417110802100" src="/assets/images/image-20230417110802100-25b6dee421474e3d87621d491c8b44c8.png" width="1439" height="614" class="img_ev3q"></p><p><img loading="lazy" alt="image-20230417110814856" src="/assets/images/image-20230417110814856-e19e510d720b36f9b4a48e9badc1ddc1.png" width="1381" height="497" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3d-set">3D-SET<a href="#3d-set" class="hash-link" aria-label="3D-SET的直接链接" title="3D-SET的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416142057478" src="/assets/images/image-20230416142057478-db1eafadf057e30697337633af2fa412.png" width="1021" height="785" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x02-set-基本过程">0x02 SET 基本过程<a href="#0x02-set-基本过程" class="hash-link" aria-label="0x02 SET 基本过程的直接链接" title="0x02 SET 基本过程的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="简介">简介<a href="#简介" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h3><p>SET 是使用信用卡交易的官方规范，发布于1996年2月。
Visa 和 MasterCard 研发的专门用于Internet上安全信用卡交易的协议。</p><ul><li>Confidentiality: 消息加密</li><li>Trust: 各方持有数字证书</li><li>Privacy: 信息按需供应</li></ul><p>动机：Internet的不安全性
作用范围：SET 仅仅关心支付问题</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="交易主体">交易主体<a href="#交易主体" class="hash-link" aria-label="交易主体的直接链接" title="交易主体的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="主体类型">主体类型<a href="#主体类型" class="hash-link" aria-label="主体类型的直接链接" title="主体类型的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416142517557" src="/assets/images/image-20230416142517557-32aceeecb82f29571aa1f00c3eae3ff8.png" width="1124" height="743" class="img_ev3q"></p><ul><li>持卡人 Cardholder</li><li>发卡机构 Issuer</li><li>商家 Merchant</li><li>收单银行 Acquirer</li><li>支付网关 Payment Gateway</li><li>认证中心 CA</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="主体证书">主体证书<a href="#主体证书" class="hash-link" aria-label="主体证书的直接链接" title="主体证书的直接链接">​</a></h4><ul><li>协议各方持有名字和密钥对</li><li>身份使用<strong>X.509v3证书</strong>和密钥关联</li></ul><p>示例：</p><p><img loading="lazy" alt="image-20230416143409327" src="/assets/images/image-20230416143409327-f1a707d1cd4a7bfdf5b9c024cce51b1c.png" width="1098" height="578" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ca-体系">CA 体系<a href="#ca-体系" class="hash-link" aria-label="CA 体系的直接链接" title="CA 体系的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416143728176" src="/assets/images/image-20230416143728176-16830a706caffc970fc6cde5b0217dc6.png" width="997" height="586" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="电子支付流程">电子支付流程<a href="#电子支付流程" class="hash-link" aria-label="电子支付流程的直接链接" title="电子支付流程的直接链接">​</a></h3><ul><li>客户在发卡行开户</li><li>客户持有银行签发的  X.509 V3 证书</li><li>商家持有两个同类品牌的证书X.509 V3<ul><li>一个用于签名 &amp;一个用于密钥交换</li></ul></li></ul><ul><li>客户向商家发订单初始化请求 （语言，ID，交易卡类型等初始请求）</li><li>商家发送证书拷贝向客户出示自己身份 （商家证书、网关证书、初始应答、初始应答做摘要后签名）</li></ul><ul><li>客户发送订单和支付信息给商家</li><li>商家向支付网关请求支付授权</li><li>商家确认向客户订单</li><li>商家向客户提供商品或者服务</li><li>商家向支付网关请求支付</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="持卡人">持卡人<a href="#持卡人" class="hash-link" aria-label="持卡人的直接链接" title="持卡人的直接链接">​</a></h4><ol><li>检查：商家证书、网关证书，用商家证书公钥检查初始应答</li><li>发送 PReq</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="商家">商家<a href="#商家" class="hash-link" aria-label="商家的直接链接" title="商家的直接链接">​</a></h4><ol><li>首先认证持卡人证书</li><li>验证签名摘要的正确性</li><li>根据 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>P</mi><mi>I</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mi>I</mi></mrow><annotation encoding="application/x-tex">H(PI)+OI</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span></span></span></span></span>，以及持卡人公钥解开的双重数字签名，验证 OI 的准确性</li><li>转发 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub><mo stretchy="false">(</mo><mtext>持卡人签名的双重数字签名</mtext><mo>+</mo><mi>P</mi><mi>I</mi><mo>+</mo><mi>H</mi><mo stretchy="false">(</mo><mi>O</mi><mi>I</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>K</mi><msub><mi>U</mi><mi>b</mi></msub><mo stretchy="false">(</mo><msub><mi>K</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">K_S(\text{持卡人签名的双重数字签名}+PI+H(OI))+KU_b(K_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">持卡人签名的双重数字签名</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 到网关</li><li>生成支付请求，摘要并签名</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="网关">网关<a href="#网关" class="hash-link" aria-label="网关的直接链接" title="网关的直接链接">​</a></h4><ol><li>用商家证书检查支付请求的完整性，完整则保留</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><msubsup><mi>U</mi><mi>b</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">KU_b^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1555em;vertical-align:-0.3013em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8542em"><span style="top:-2.3987em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span><span style="top:-3.1031em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em"><span></span></span></span></span></span></span></span></span></span></span>解数字信封，得到对称密钥 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">K_S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> ，用  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">K_S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 解得 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>持卡人签名的双重数字签名</mtext><mo>+</mo><mi>P</mi><mi>I</mi><mo>+</mo><mi>H</mi><mo stretchy="false">(</mo><mi>O</mi><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{持卡人签名的双重数字签名}+PI+H(OI)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord text"><span class="mord cjk_fallback">持卡人签名的双重数字签名</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mclose">)</span></span></span></span></span> ，验证双重签名，完整则保留</li><li>通过金融专用网，将这些原始信息都发给银行</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="银行">银行<a href="#银行" class="hash-link" aria-label="银行的直接链接" title="银行的直接链接">​</a></h4><p>（重复网关1、2操作，获得PI数据）
比较支付请求与支付信息，开始支付流程</p><blockquote><p>验证电子证书9次
验证数字签名6次
传递证书7次
进行签名5次
对称加密和非对称加密4次</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x03-set-使用的基本技术">0x03 SET 使用的基本技术<a href="#0x03-set-使用的基本技术" class="hash-link" aria-label="0x03 SET 使用的基本技术的直接链接" title="0x03 SET 使用的基本技术的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数字证书">数字证书<a href="#数字证书" class="hash-link" aria-label="数字证书的直接链接" title="数字证书的直接链接">​</a></h3><ul><li>由CA签发</li><li>数据包括<ul><li>谁拥有该证书</li><li>谁签发的该证书</li><li>报废日期</li><li>用户名和邮件地址</li></ul></li><li>数字 ID一般含有下列信息 :<ul><li>公钥，名字，地址</li><li>公钥过期日期, 颁发数字证书的CA名字</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数字签名">数字签名<a href="#数字签名" class="hash-link" aria-label="数字签名的直接链接" title="数字签名的直接链接">​</a></h3><p><img loading="lazy" alt="image-20230416144111472" src="/assets/images/image-20230416144111472-0dc79ba5cdf1b9f8a6c57165e22f7f8b.png" width="1447" height="640" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="双重数字签名">双重数字签名<a href="#双重数字签名" class="hash-link" aria-label="双重数字签名的直接链接" title="双重数字签名的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="概念与作用">概念与作用<a href="#概念与作用" class="hash-link" aria-label="概念与作用的直接链接" title="概念与作用的直接链接">​</a></h4><p>概念:  将两个消息连接在一起，这两个消息面向的对象不同。</p><ul><li>Order Information (OI):  客户给商家</li><li>Payment Information (PI):  客户给银行</li></ul><p>目标:  <strong>按需分发消息</strong></p><ul><li>商家不需要卡信息</li><li>银行需要订单信息</li><li>保护客户隐私</li></ul><p><strong>确保信息不被非法使用</strong>。
否则的话，商家有可能将多个支付信息和订单信息交叉组合，牟利。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="331签名过程">3.3.1签名过程<a href="#331签名过程" class="hash-link" aria-label="3.3.1签名过程的直接链接" title="3.3.1签名过程的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230416145226691" src="/assets/images/image-20230416145226691-bd3dbf5ddc9a92f539f77aae6f065e84.png" width="1408" height="669" class="img_ev3q">
将PI和OI分别初次hash.
连接成 <!-- -->[H(PI) || H(OI)]<!-- --> 再hash.
客户私钥加密产生双重签名.
DS =  EKRC <!-- -->[ H(H(PI) || H(OI)) ]</p><p>商家收到 OI 校验签名.
银行收到 PI 校验签名.
客户连接OI和PI，证明该关联.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x04-set-具体流程">0x04 SET 具体流程<a href="#0x04-set-具体流程" class="hash-link" aria-label="0x04 SET 具体流程的直接链接" title="0x04 SET 具体流程的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set-消息流">SET 消息流<a href="#set-消息流" class="hash-link" aria-label="SET 消息流的直接链接" title="SET 消息流的直接链接">​</a></h3><p><img loading="lazy" alt="图片1" src="/assets/images/图片1-582578b5b0720ae5764aba51763ff748.png" width="1411" height="650" class="img_ev3q"></p><p><img loading="lazy" alt="图片2" src="/assets/images/图片2-d37d70d845486de829acde2f9ba12d16.png" width="541" height="681" class="img_ev3q"></p><p><img loading="lazy" alt="图片3" src="/assets/images/图片3-f7663aa6060a5489af7eaa847e6a2bb5.png" width="668" height="465" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="支付过程初始化">支付过程初始化<a href="#支付过程初始化" class="hash-link" aria-label="支付过程初始化的直接链接" title="支付过程初始化的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="initreqinitres">InitReq/InitRes<a href="#initreqinitres" class="hash-link" aria-label="InitReq/InitRes的直接链接" title="InitReq/InitRes的直接链接">​</a></h4><ul><li>明文传输</li><li>Cardholder 浏览选择商品, 下订单，选择银行卡</li><li>初始化完成 :<ul><li>获取商家和acquirer的证书</li><li>出示银行卡</li><li>关联事务id与购买行为</li></ul></li></ul><p><img loading="lazy" alt="图片4" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmwAAACTCAMAAAAEELXyAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURf///wAAAGtrc6Wlrdbe1vf377W1tQAICObm3u/m7ykhKXN7c3t7hIyEjOYQ5uYQrebWWuZj5uZaWubWEOZaEOZjrb29xUpKQikxMc7O1hAQCBAQGc7OxUJK5nNKjBBK5kJKtRBKta1KvaWlnFJaWq1KlEpKhEoZOntK70IZjK0ZOnMZlBlKjK0Z7xAZjHsZOrWElEIZY60ZEBlKYxAZY3sZEOat5ubepSEZGZSUjDE6OhBCOhBCEJSEa+bWe+aE5uZae+bWMeZaMeaErZScnGNaY0rvWkrvGa1K761KOntKOq1KEHtKEEpKUlJKGeatvTFKGeatnJwZY2sZvTpCQrWEa4R774R7xa29a62UEK29KXu9a3uUEHu9Ka29Sq1zEK29CHu9SntzEHu9CEII5hAI5kIItRAItZxKY2tKvXMIY60IvVKl77XmrVKlrRml7xmlrRmlaxmlKVIZEFJ771J7rRl77xl7rRl7axl7KVLO71LOrealWuYpWualEOYpEBnO7xnOrRnOaxnOKVKlzrXmjFKljBmlzhmljBmlShmlCDEZEFJ7zlJ7jBl7zhl7jBl7Shl7CFLOzlLOjOaEWuYIWuaEEOYIEBnOzhnOjBnOShnOCNY65tY6rZwZlGsZ770ZY4wZvWtrY7V777V7xbXm763va0qla62UQq3vKUqlKYTvrXvva3uUQnvvKYTv74Sc77W95ntKY4ScxUp7a0p7KYTFrYTF70rOa0rOKbXmzq3vSkqlSq1zQq3vCEqlCITvjHvvSntzQnvvCITvzkp7Skp7CITFjITFzkrOSkrOCFLv71Lvreale+Ype+alMeYpMRnv7xnvrRnvaxnvKVLvzlLvjOaEe+YIe+aEMeYIMRnvzhnvjBnvShnvCEIp5hAp5kIptRAptb1KY4xKvXMpY60pvfc65vc6rb0ZlIwZ77Wc7xAQOrWcxeb3znuclO/O5rW9lOb3a+b3EOb3nOb3QubexRAAKdbm79737973/72lrRAAAHtrc//3/wAAAJcx3toAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAYuUlEQVR4Xu2dT3KjSrD1KYMQBWIqZMFMLAIR4Rka+o28k7eMbxes8Bs57GjZ8c7JKjCS3d1Wt6Vru/N3b3dLiL9VWSczC6gKFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRFEVRvhJRazL/UejKNAk600eBrQ0oIv/Db4h6U0c5t8isX/Q7QtPaoDZtEFQlttvXof8BdFgiewNV2LzrLDru75AYmw+XF5fziv92xkRB3HLPffjqXJMOv9zlsqbHxgV3w3Wj1Ex/8cxyUwdx2h7+lOQpii+Xgqxjv/Df5vrY2JpWjM0GkRibSd9VThb1sbt35lEs/cLfAGObOWOLaWzgpbq6BtXrly7Dsn6PsW25v0NC7OLJf46b8tjYcMTDq7O5P2b50mRi2IxQVGwVb5yJ3aK84lU7vW47nH2Zox2ag9/+WZIjYxO6+U4aZCet0i/8JWjyqLbclEGVmt4v/A2xVzaLOmSlh/g8WNtmnrJWe5pi8F5l26evhGrWjmcTN07ZQrOPgmWb4gvsCBb0Aq62ySlg+Wrf+WUQx5rr/ChNbXGZ127xFFG2KuUeB2xr0o57ypomDKpmPVHtf5eq3WdBhJJBS+xRWjkqfIcGmYYzGNssyEyKtWwI5aqd04nrvSnC3oTBQ1EOZVjB2wXBAsYWrFC9qLWwb1FfP+amvOlS6EFmihhayboMZt3etCHc3iwoTDGDsomVRaVZyN7EcGhfMD+IFZRtCXWg2GzE+uK2jIJw38dc+hxl5T7D9lC2KhMBwglDovjBphM3OirbA8xsJUc8bGqIIbzSRYPiYY2tXHZgI7QKtCmIrmsT9K499rpBoUHZDtzozXzQzIhnUY4F9U9zfYfijpzimzaSGkMVmpUY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" width="620" height="147" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="initreq">InitReq<a href="#initreq" class="hash-link" aria-label="InitReq的直接链接" title="InitReq的直接链接">​</a></h4><ul><li><p>前提:</p><ul><li>持卡人需持有商家和支付网关的证书</li></ul></li><li><p>客户向商家发送初始请求信息，获取证书</p><ul><li>信用卡的品牌</li><li>相应ID</li><li>新鲜数</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="initres">InitRes<a href="#initres" class="hash-link" aria-label="InitRes的直接链接" title="InitRes的直接链接">​</a></h4><p>Merchant replies (InitRes):</p><ul><li>Merchant + Acquirer certificates</li><li>Globally unique transaction ID
Challenge variable and date proves
freshness of variables</li></ul><p><img loading="lazy" alt="图片5" src="/assets/images/图片5-e80a5d824db4858670a2ae1fb51a6f31.png" width="849" height="278" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="purchase-order">Purchase Order<a href="#purchase-order" class="hash-link" aria-label="Purchase Order的直接链接" title="Purchase Order的直接链接">​</a></h3><ul><li>持卡人校验证书并产生OI和PI.</li><li>下单 : PReq/PRes</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="preq">PReq<a href="#preq" class="hash-link" aria-label="PReq的直接链接" title="PReq的直接链接">​</a></h4><p>下单的请求</p><p>简化的PReq示意图</p><p><img loading="lazy" alt="图片7" src="/assets/images/图片7-41b7a65ed68ff40c33c4a4a2c86669d5.png" width="696" height="182" class="img_ev3q"></p><p><img loading="lazy" alt="图片8" src="/assets/images/图片8-de2b8c7a3f1a39b1778e38e0b9a49d4a.png" width="750" height="655" class="img_ev3q"></p><ul><li>PReq 交易内容由两部分组成:<ul><li>订单信息 (OI) : links to order description</li><li>支付信息(PI): amount, card data, IDs</li></ul></li><li><strong>Dual signature</strong> links the order with them payment</li></ul><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>R</mi><mi>e</mi><mi>q</mi><mo>=</mo><msub><mi>K</mi><mi>s</mi></msub><mo stretchy="false">(</mo><mtext>持卡人签名的双重数字签名</mtext><mo>+</mo><mi>P</mi><mi>I</mi><mo>+</mo><mi>H</mi><mo stretchy="false">(</mo><mi>O</mi><mi>I</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>K</mi><msub><mi>U</mi><mi>b</mi></msub><mo stretchy="false">(</mo><msub><mi>K</mi><mi>s</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>H</mi><mo stretchy="false">(</mo><mi>P</mi><mi>I</mi><mo stretchy="false">)</mo><mo>+</mo><mi>O</mi><mi>I</mi><mo>+</mo><mtext>持卡人签名的双重数字签名</mtext><mo>+</mo><mtext>持卡人证书</mtext></mrow><annotation encoding="application/x-tex">PReq = K_s(\text{持卡人签名的双重数字签名}+PI+H(OI)) + KU_b(K_s) + H(PI) + OI + \text{持卡人签名的双重数字签名} + \text{持卡人证书}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.00773em">PR</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">持卡人签名的双重数字签名</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord text"><span class="mord cjk_fallback">持卡人签名的双重数字签名</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord cjk_fallback">持卡人证书</span></span></span></span></span></span></p><p><img loading="lazy" alt="图片6" src="/assets/images/图片6-5f59af7d9ad3c181570166743b4185db.png" width="831" height="556" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="商家验证卡用户的身份和授权">商家验证卡用户的身份和授权<a href="#商家验证卡用户的身份和授权" class="hash-link" aria-label="商家验证卡用户的身份和授权的直接链接" title="商家验证卡用户的身份和授权的直接链接">​</a></h4><ul><li>存储 PI 以转发给acquirer</li><li>遍历信任链，校验持卡人证书</li><li>校验双重签名</li><li>从支付网关那里获取授权</li><li>发送响应给持卡人，确认订单</li><li>若授权延迟 PRes 给持卡人“请稍后查询”消息</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="preq-的验证">PReq 的验证<a href="#preq-的验证" class="hash-link" aria-label="PReq 的验证的直接链接" title="PReq 的验证的直接链接">​</a></h5><p><img loading="lazy" alt="图片9" src="/assets/images/图片9-49e681553ced92681cdf82b792787940.png" width="576" height="541" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="pres">PRes<a href="#pres" class="hash-link" aria-label="PRes的直接链接" title="PRes的直接链接">​</a></h4><p>下单的回复</p><p>简化的PRes示意图</p><p><img loading="lazy" alt="图片10" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAApIAAAC3CAMAAACWqE74AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURf///wAAAPf37xkZGd7m5pSUjLW1tXNzc0JKSsXFxTEpKe/v75ScnCkhKUJCQqWlpSEZGd7W3r1Sxb1Sc4RSxZTFpb0Zxb0Zc4QZxRlScxlSxRkZcxkZxVrO5lqE5hBSQhAIEM7WzgAICMVSQkpS70oZnMUZQkoZ78VSEMUZEL2EnEpSxUoZc0oZxYSEjO9ajO9aOu8ZjO8ZOu+cjO+cOu9aY+9aEO8ZY+8ZEO+cY++cEBk6EFrv5lql5hkIOmsZQmtSGWsZEEoZQkpSGUoZEFpjY+/Fte9r5u8Q5u9rte8QtXuEe+/ejO/eOu/eY+/eEIzvEIzFEFLOEFKEEBnOEBmEEGtjaxlaEKXv3qXF3inOpSmEpYTv3oTF3gjOpQiEpVJKSlJaUjE6Ou+c5u9C5u+cte9Ctb3vEL3FEHtze0pClHNSlJRCQpQIQpRCEJQIEMXvpYQpnIzvMYzvc4ycOr21tYzFMYQpc4zFc4ycEFLOMVKEMRnOMRmEMVLOc6Wca1KEcynO5imE5lrOtVqEtRnOcxmEc1LvEFKlEBnvEBmlEMXOpYQInIzvUox7OoQIc4zFUox7EFLOUqV7a1KEUgjO5giE5lrOlFqElBnOUhmEUq1S761SnHNS74Tvpa0Z760ZnHMZ7whSnAhS7wgZnAgZ7ynvpSmlpQjvpQilpcXm773vc72c772cOr3vMYyc7xAhSu/vvb3FMYxSa73Fc72cxb2cEIycxXuUY73vUr177717Oox7773FUr17xb17EIx7xVLvc8Wca1Klc1LvMVKlMSnv5iml5hnvMRmlMVrvtVqltRnvcxmlc1LvUsV7a1KlUgjv5gil5lrvlFqllBnvUhmlUkpjlJRSlJRjQpQpQpRjEJQpEM5S7zFaQs5SnJRS76Xvpc4Z784ZnJQZ7ylSnClS7ykZnCkZ7+/O92tSSsW95kpCa+//Ou//vcWlnMW1nDEhSpR7nBAhKUJaSntzWggZCCEIAAgZGffv5ub395SUpeb///f3/wAIAAAAADTAlswAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAY3ElEQVR4Xu2dS3biuhaGLfPQsmVJaAZSBuBZ0KKvNlIvA9Cgq5onhLW4J7Du3rJJTCpJJYCJc6yPVCHAEAf//rW3rEeWSCQSiUQikUgkEolEIpFIJBKJRCKRSCQSiUQikUgkEolEIpFIJBKJxH8TNthbYpwEMlRcu4eJkTHXbIhkwrY7mBgbctIWBoagbSExNoJuCwMjSXK0zJMkE8MiSTIxMOYplkwMi+SSiYGRJJkYGEmSiYGRYsnEwEgumRgYSZKJgZEkmRgY58WSqraPtjbHEsXSdUmSHC3nuaQpsfuYCE9taROu3b0xSXK0nClJT7zwpFTHkkiSTFyJc12Sh0x5Ivem9KBLQtAmc2WMidpkULpMpEmSo+W8WNJwPs/Ymkgo+ZD9KkkAHQYPdXgNUmRSECIv0mSS5Gg5t+J+QDWCEE1ZFjhaAiRZcQwriVCZjKWLNJkkOVrOjiWJBvVlWQGluwMOlAmeSzBISmaZJZ4F+9RufBZJkqPlLEnuDVTMhKwUiBNLGmtrR8ik5KUmm+l8QazJ243PI0lytJwZS5a6LmICU5ScCl1ACQPJiDasKomv4pbnkiQ5Ws6tuCHjbks+VAT144moZFVJKX9BLe74Qu6aTc4iSXK0zO/awpcw5WLelAruC8MnJoMAMjZO7qDCztUTszH3PpskydFy3ghFVWIqA+yNh4x7RijDqNJVcubraVatqXRJkomzOLddctJIElwSJGn0BDIdbIyESPJxmj1igWOAeTZJkqPlvFhSbfwxlhQCpCd1BZaoqJ5E99zPneaXdcVIkhwt50myf5IkR0uSZGJgpLE3iYGRXDIxMM5rl+yfJMnRMtSZ01yS5FiBWLL+MjP8ef/W/lzArOJJkmMFYkls1x4e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" width="658" height="183" class="img_ev3q"></p><ul><li>完成代码: 交易状态<ul><li>例如. 授权完成 complete</li></ul></li><li>结果: 交易的授权/捕获代码 </li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="认证过程">认证过程<a href="#认证过程" class="hash-link" aria-label="认证过程的直接链接" title="认证过程的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="authreqauthres">AuthReq/AuthRes<a href="#authreqauthres" class="hash-link" aria-label="AuthReq/AuthRes的直接链接" title="AuthReq/AuthRes的直接链接">​</a></h4><ul><li>校验持卡人的信用</li><li>含有 PI （来自 PReq）</li><li>含有 H(OI) ，表明和PI的一致性</li><li>订单信息明文不发送给 Acquirer</li><li>商家签名并加密</li><li>结合授权和捕获＝销售交易 </li><li>根据AuthRes结果运输商品</li></ul><p><img loading="lazy" alt="image-20230417105701619" src="/assets/images/image-20230417105701619-fa1eed251745cd4c05cb4e9616f477e0.png" width="1134" height="257" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="acquirer处理">Acquirer处理<a href="#acquirer处理" class="hash-link" aria-label="Acquirer处理的直接链接" title="Acquirer处理的直接链接">​</a></h4><ul><li>解密 AuthReq</li><li>校验商家签名</li><li>解密来自于持卡人的 PI</li><li>校验双重签名</li><li>从PI中抽取卡数据</li></ul><p>作用</p><ul><li>确保 PI 和 AuthReq 的一致性</li><li>校验持卡人和商家对于订购行为的一致性: H(Order) ，PI 和 AuthReq</li><li>通过金融网络获取授权信息</li><li>生成 AuthRes及其 Capture Token</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="authreq">AuthReq<a href="#authreq" class="hash-link" aria-label="AuthReq的直接链接" title="AuthReq的直接链接">​</a></h4><p>商家发给<strong>支付网关</strong></p><p><img loading="lazy" alt="image-20230417105619372" src="/assets/images/image-20230417105619372-c409f01c5be0ce2915776f4d4baaeb60.png" width="1264" height="616" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="authres">AuthRes<a href="#authres" class="hash-link" aria-label="AuthRes的直接链接" title="AuthRes的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230417105915687" src="/assets/images/image-20230417105915687-7d51a36ee90adaeef35791088c882f7c.png" width="1228" height="603" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="支付完成">支付完成<a href="#支付完成" class="hash-link" aria-label="支付完成的直接链接" title="支付完成的直接链接">​</a></h3><ul><li>完成授权 交易的支付</li><li>通过捕获令牌来完成支付</li><li>可能多次 AuthResponses的令牌累积后完成</li><li>Capture Token = 金额证据</li></ul><p><img loading="lazy" alt="image-20230417110537790" src="/assets/images/image-20230417110537790-9271f50a0fb107b6f6baa82e6deef1bc.png" width="1134" height="279" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cap-token">Cap Token<a href="#cap-token" class="hash-link" aria-label="Cap Token的直接链接" title="Cap Token的直接链接">​</a></h4><p><img loading="lazy" alt="image-20230417110327702" src="/assets/images/image-20230417110327702-aad11f8921d2d9c8d82a1bb7607b89a0.png" width="1293" height="873" class="img_ev3q"></p><p><img loading="lazy" alt="image-20230417110444077" src="/assets/images/image-20230417110444077-b97dd63136dda4eae504bcdfd2e786a8.png" width="1381" height="853" class="img_ev3q"></p><p><img loading="lazy" alt="image-20230417110452893" src="/assets/images/image-20230417110452893-ba9a4e056e8d9795d95ad135884d99ff.png" width="1329" height="685" class="img_ev3q"></p><blockquote><p>SET协议交易过程复杂度</p><p>验证电子证书9次
验证数字签名6次
传递证书7次
进行签名5次
对称加密和非对称加密4次</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="0x05-结语">0x05 结语<a href="#0x05-结语" class="hash-link" aria-label="0x05 结语的直接链接" title="0x05 结语的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set-应用场景">SET 应用场景<a href="#set-应用场景" class="hash-link" aria-label="SET 应用场景的直接链接" title="SET 应用场景的直接链接">​</a></h3><p><img loading="lazy" alt="image-20230417110957594" src="/assets/images/image-20230417110957594-4817159010e1c7963e8128685cd35b9c.png" width="1193" height="586" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set-与-ssl-的比较">SET 与 SSL 的比较<a href="#set-与-ssl-的比较" class="hash-link" aria-label="SET 与 SSL 的比较的直接链接" title="SET 与 SSL 的比较的直接链接">​</a></h3><p>SET远远不止是一个技术方面的协议，它还说明了每一方所持有的数字证书的含义，希望得到数字证书以及响应信息的各方应有的动作，与一笔交易紧密相关的责任分担。<br>
<!-- -->SET实现非常复杂，商家和银行都需要改造系统以实现互操作，并且还需要认证中心的支持。<br>
<!-- -->SET是一个多方的报文协议，它定义了银行、商家、持卡人之间的必须的报文规范。<br>
<!-- -->SSL只是简单地在两方之间建立一条安全连接。<br>
<!-- -->SSL是面向连接的，而SET允许各方之间的报文交换不是实时的。
另外，SET报文能够在银行内部网或者其他网络上传输，而SSL之上的卡支付系统只能与Web浏览器捆绑在一起。<br>
<!-- -->SSL相对与SET安全性要弱，实际上当初它并不是为支持电子商务而设计的。<br>
<!-- -->很多银行和电子商务解决方案提供商仍然在使用SSL来构建更多的安全支付系统，但是如果没有经裁剪的客户方软件的话，基于SSL的系统式不能达到像SET这种银行卡专用支付协议所能达到的安全性的。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Axsl666/Axsl666.github.io/tree/master/docs/NetworkProtocolSecurity/SET.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/NetworkProtocolSecurity/ipsec"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">IPsec协议</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/NetworkProtocolSecurity/PGP"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">PGP协议</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#0x01-前言" class="table-of-contents__link toc-highlight">0x01 前言</a><ul><li><a href="#internet上的电子商务安全问题" class="table-of-contents__link toc-highlight">Internet上的电子商务安全问题</a></li><li><a href="#电子交易的主要模式" class="table-of-contents__link toc-highlight">电子交易的主要模式</a></li><li><a href="#3d-安全支付" class="table-of-contents__link toc-highlight">3D 安全支付</a></li></ul></li><li><a href="#0x02-set-基本过程" class="table-of-contents__link toc-highlight">0x02 SET 基本过程</a><ul><li><a href="#简介" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#交易主体" class="table-of-contents__link toc-highlight">交易主体</a></li><li><a href="#电子支付流程" class="table-of-contents__link toc-highlight">电子支付流程</a></li></ul></li><li><a href="#0x03-set-使用的基本技术" class="table-of-contents__link toc-highlight">0x03 SET 使用的基本技术</a><ul><li><a href="#数字证书" class="table-of-contents__link toc-highlight">数字证书</a></li><li><a href="#数字签名" class="table-of-contents__link toc-highlight">数字签名</a></li><li><a href="#双重数字签名" class="table-of-contents__link toc-highlight">双重数字签名</a></li></ul></li><li><a href="#0x04-set-具体流程" class="table-of-contents__link toc-highlight">0x04 SET 具体流程</a><ul><li><a href="#set-消息流" class="table-of-contents__link toc-highlight">SET 消息流</a></li><li><a href="#支付过程初始化" class="table-of-contents__link toc-highlight">支付过程初始化</a></li><li><a href="#purchase-order" class="table-of-contents__link toc-highlight">Purchase Order</a></li><li><a href="#认证过程" class="table-of-contents__link toc-highlight">认证过程</a></li><li><a href="#支付完成" class="table-of-contents__link toc-highlight">支付完成</a></li></ul></li><li><a href="#0x05-结语" class="table-of-contents__link toc-highlight">0x05 结语</a><ul><li><a href="#set-应用场景" class="table-of-contents__link toc-highlight">SET 应用场景</a></li><li><a href="#set-与-ssl-的比较" class="table-of-contents__link toc-highlight">SET 与 SSL 的比较</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Notes</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/Axsl666/Axsl666.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Axsl666. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b33e5218.js"></script>
<script src="/assets/js/main.1db32412.js"></script>
</body>
</html>